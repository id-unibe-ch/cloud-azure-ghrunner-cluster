---
namespace: id-private-ghec-runner
resources:
  - ../base
configMapGenerator:
  - name: helm-values
    files:
      - helm-values.yaml
patches:
  - target:
      group: helm.toolkit.fluxcd.io 
      version: v2
      kind: HelmRelease
      name: arc-runner
    path: oci-namespace-patch.yaml
  - target:
      group: secrets-store.csi.x-k8s.io
      version: v1
      kind: SecretProviderClass
      name: azure-kvname-wi
    path: keyvault-patch.yaml
  - target:
      kind: Namespace
    patch: |
      - op: add
        path: /metadata/annotations
        value:
          scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator": "Equal", "effect":"NoSchedule", "key":"private.runner", "value":"id"}]'
          scheduler.alpha.kubernetes.io/tolerationsWhitelist: '[{"operator": "Equal", "effect":"NoSchedule", "key":"private.runner", "value":"id"}]'
generatorOptions:
  disableNameSuffixHash: true